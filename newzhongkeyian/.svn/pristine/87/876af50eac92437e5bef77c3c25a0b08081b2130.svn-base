<!-- 添加密码授权 -->
<template>
  <div>
    <el-dialog
      title="添加密码授权"
      :visible.sync="dialogAddpassword"
      :before-close="handleDialogClose"
      width="500px"
    >
      <el-form :model="form" class="formboxs">
        <el-form-item label="房间编号:" :label-width="formLabelWidth">
          <el-input v-model="thisroomobj.roomname" autocomplete="off" :disabled="true"></el-input>
        </el-form-item>
        <el-form-item label="房间位置:" :label-width="formLabelWidth">
          <el-input v-model="thisroomobj.roomlocation" autocomplete="off" :disabled="true"></el-input>
        </el-form-item>
        <el-form-item label="密码:" :label-width="formLabelWidth">
          <el-input type="number" v-model="form.mm" autocomplete="off" :maxlength="6"></el-input>
        </el-form-item>
        <el-form-item label="重复密码:" :label-width="formLabelWidth">
          <el-input type="number" v-model="form.cfmm" autocomplete="off" :maxlength="6"></el-input>
        </el-form-item>
        <el-form-item label="有效结束时间:" :label-width="formLabelWidth">
          <el-date-picker
            value-format="yyyy-MM-dd HH:mm"
            format="yyyy-MM-dd HH:mm"
            popper-class="dateQueryList"
            v-model="form.edate"
            type="datetime"
            placeholder="(为空表示不限时间)"
          ></el-date-picker>
        </el-form-item>
        <el-form-item label="可使用次数:" :label-width="formLabelWidth">
          <el-input
            type="number"
            v-model="form.availability"
            autocomplete="off"
            placeholder="不填为不限次数"
          ></el-input>
        </el-form-item>
        <el-form-item label="备注:" :label-width="formLabelWidth">
          <el-input v-model="form.bz" autocomplete="off"></el-input>
        </el-form-item>
        <el-form-item label="可开门时间段:" :label-width="formLabelWidth">
          <el-time-picker
            style="width:300px!important;"
            value-format="HH:mm"
            format="HH:mm"
            is-range
            v-model="valuedate"
            range-separator="至"
            start-placeholder="开始时间"
            end-placeholder="结束时间"
            placeholder="选择时间范围"
            @change="getSTime"
          ></el-time-picker>
        </el-form-item>
      </el-form>
      <div slot="footer" class="dialog-footer">
        <el-button type="primary" @click="Addpassword">确定添加</el-button>
      </div>
    </el-dialog>
  </div>
</template>

<script>
export default {
  props: ["dialogAddpassword", "pagesid", "thisroomobj"],
  data() {
    return {
      formLabelWidth: "100",
      value4: [new Date(2016, 9, 10, 8, 40), new Date(2016, 9, 10, 9, 40)],
      valuedate: [new Date("2022-10-19 00:00"), new Date("2022-10-19 23:59")], //可开门时间段
      valuedatestr: "0",
      form: {
        mm: "", //密码
        cfmm: "", //重复密码
        edate: "", //有效结束时间
        stime: "",
        etime: "",
        availability: "", //可使用次数
        bz: "" //备注
      }
    };
  },

  //   components: {},

  //   computed: {},

  //   mounted: {},
  watch: {
    dialogAddpassword(val) {
      if (!val) {
        (this.valuedatestr = "0"),
          (this.form = {
            mm: "", //密码
            cfmm: "", //重复密码
            edate: "", //有效结束时间
            stime: "",
            etime: "",
            availability: "", //可使用次数
            bz: "" //备注
          });
      }
    }
  },
  methods: {
    //时间选择器
    getSTime(val) {
      this.valuedate = val;
      this.valuedatestr = 1;
    },
    Addpassword() {
      if (this.form.mm == "" || this.form.cfmm == "") {
        this.$message.error("请输入密码");
        return;
      }
      if (this.form.mm != this.form.cfmm) {
        this.$message.error("两次密码不匹配");
        return;
      }
      let stime = this.valuedate[0] || ""; //授权开始时间
      let etime = this.valuedate[1] || ""; //授权结束时间
      if (this.valuedatestr == 0) {
        stime = "00:00";
        etime = "23:59";
      }
      this.form.roomname = this.thisroomobj.roomname;
      this.form.roomlocation = this.thisroomobj.roomlocation;
      this.form.etime = etime;
      this.form.stime = stime;
      this.$emit("Addpassword", this.form);
      this.handleDialogClose();
    },

    //关闭事件
    handleDialogClose() {
      this.$emit("handleDialogClose", false);
    }
  }
};
</script>
<style lang='scss' scoped>
.formboxs .el-form-item {
  width: 410px;
  display: block !important;
  text-align: left;
  label,
  .el-form-item__content {
    display: inline-block !important;
    vertical-align: middle;
  }
}
</style>
<style lang='scss'>
input::-webkit-input-placeholder {
  /* WebKit browsers */
  color: #999;
  font-size: 13px;
}

input::-moz-placeholder {
  /* Mozilla Firefox 19+ */
  color: #999;
  font-size: 13px;
}

input:-ms-input-placeholder {
  /* Internet Explorer 10+ */
  color: #999;
  font-size: 13px;
}
.formboxs .el-form-item label,
.formboxs .el-form-item .el-form-item__content {
  display: inline-block !important;
  vertical-align: middle;
}
.formboxs .el-form-item label {
  width: 110px;
}
.formboxs .el-date-editor.el-input {
  width: 280px !important;
}
</style>