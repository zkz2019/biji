(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0668bf86"],{"07d4":function(e,t,o){"use strict";var i=o("7aea"),a=o.n(i);a.a},"12b4":function(e,t,o){},"1ea4":function(e,t,o){"use strict";var i=o("8007"),a=o.n(i);a.a},3129:function(e,t,o){"use strict";var i=o("12b4"),a=o.n(i);a.a},3474:function(e,t,o){},"386d":function(e,t,o){"use strict";var i=o("cb7c"),a=o("83a1"),l=o("5f1b");o("214f")("search",1,function(e,t,o,s){return[function(o){var i=e(this),a=void 0==o?void 0:o[t];return void 0!==a?a.call(o,i):new RegExp(o)[t](String(i))},function(e){var t=s(o,e,this);if(t.done)return t.value;var n=i(e),c=String(this),r=n.lastIndex;a(r,0)||(n.lastIndex=0);var d=l(n,c);return a(n.lastIndex,r)||(n.lastIndex=r),null===d?-1:d.index}]})},"3d2a":function(e,t,o){},"45bb":function(e,t,o){"use strict";var i=o("5deb"),a=o.n(i);a.a},"466a":function(e,t,o){},"4e8c":function(e,t,o){},"4fb6":function(e,t,o){},"5deb":function(e,t,o){},6535:function(e,t,o){"use strict";var i=o("f370"),a=o.n(i);a.a},"6a99c":function(e,t,o){"use strict";var i=o("3d2a"),a=o.n(i);a.a},"6ad2":function(e,t,o){},"6d72":function(e,t,o){"use strict";var i=o("e90f"),a=o.n(i);a.a},"71c2":function(e,t,o){},7232:function(e,t,o){"use strict";var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],attrs:{title:e.title,visible:e.FileimportVisible,width:"450px","element-loading-text":"上传中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)","before-close":e.handleDialogClose},on:{"update:visible":function(t){e.FileimportVisible=t}}},[o("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"doUpload",limit:1,"file-list":e.fileList,"before-upload":e.beforeUpload}},[o("div",[o("span",[e._v("excel文件: ")]),o("div",{staticClass:"el-upload-list__item-name",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.fileName))]),o("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")])],1),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传excel文件，且不超过100MB")]),e.is_nodr?o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.nodr)+"\n          "),o("el-button",{attrs:{size:"mini",type:"success"},on:{click:e.getexcel}},[e._v("下载excel")])],1):e._e(),e.is_ok?o("div",{staticClass:"el-upload__tip cos",attrs:{slot:"tip"},slot:"tip"},[e._v("文件全部导入成功！"),o("i",{staticClass:"el-icon-success"})]):e._e()]),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.handleDialogClose}},[e._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitUpload()}}},[e._v("确定")])],1)],1)],1)},a=[],l=(o("7f7f"),o("28a5"),o("a78e")),s=o.n(l),n={props:["title","FileimportVisible","uploadURL","downloadURL"],data:function(){return{fileList:[],fileName:"",loading2:!1,nodr:"",is_nodr:!1,is_ok:!1,resultfail:"",thisresultfail:""}},components:{},computed:{},mounted:function(){},methods:{handleDialogClose:function(){this.fileName="",this.loading2=!1,this.nodr="",this.is_ok=!1,this.is_nodr=!1,this.resultfail="",this.thisresultfail="",this.$refs.upload.clearFiles(),this.$emit("handleDialogClose",!1)},beforeUpload:function(e){console.log(e,"文件"),this.files=e;var t="xlsx"===e.name.split(".")[1],o=e.size/1024/1024<100;t?o?(this.fileName=e.name,this.is_nodr=!1,this.is_ok=!1):this.$message.warning("上传模板大小不能超过 100MB!"):this.$message.warning("上传模板只能是xlsx格式!")},submitUpload:function(){var e=this;if(console.log("上传"+this.files.name),""!=this.fileName){this.loading2=!0;var t=new FormData;t.append("file",this.files,this.fileName),console.log(this.files);var o=s.a.get("token");this.$post("".concat(this.uploadURL,"?token=").concat(o),t,"2").then(function(t){console.log(t),e.loading2=!1,e.$message({message:"操作成功",type:"success",duration:1500}),1==t.result.resultstate?e.is_ok=!0:(e.is_nodr=!0,e.nodr=t.result.resultmsg,e.resultfail=t.result.resultfail,e.thisresultfail=t.result.resultfail.split("/")[1])}).catch(function(t){e.loading2=!1,console.log(t),e.$message.error(t.resultMsg||"操作失败或连接失败")})}else this.$message.warning("请选择要上传的文件！")},getexcel:function(){var e=this;console.log(this.resultfail);var t=s.a.get("token");this.$post("".concat(this.downloadURL,"?token=").concat(t,"&filepath=").concat(this.resultfail),{},"3").then(function(t){console.log(t),e.download(t)}).catch(function(t){console.log(t),e.download(t)})},download:function(e){var t=e;document.createElement("a");console.log("blob",t);var o=window.URL.createObjectURL(t);console.log("blobURL",o);var i=document.createElement("a");i.style.display="none",i.href=o,i.setAttribute("download",this.thisresultfail),"undefined"===typeof i.download&&i.setAttribute("target","_blank"),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(o)}}},c=n,r=(o("45bb"),o("2877")),d=Object(r["a"])(c,i,a,!1,null,"ddc713ec",null);d.options.__file="dialogFile.vue";t["a"]=d.exports},"7aea":function(e,t,o){},"7c22":function(e,t,o){},8007:function(e,t,o){},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"8bf6":function(e,t,o){"use strict";var i=o("7c22"),a=o.n(i);a.a},"8d98":function(e,t,o){"use strict";var i=o("3474"),a=o.n(i);a.a},"9cb4":function(e,t,o){"use strict";var i=o("4e8c"),a=o.n(i);a.a},a6c6:function(e,t,o){},b277:function(e,t,o){"use strict";var i=o("466a"),a=o.n(i);a.a},cae5:function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-container",{staticStyle:{height:"100%",border:"1px solid #eee"}},[o("el-aside",{staticClass:"elasidebox",staticStyle:{"background-color":"#fff"},attrs:{width:"150px"}},[o("el-tabs",{staticStyle:{height:"100%",width:"100%"},attrs:{"tab-position":"left"},on:{"tab-click":e.handleClick},model:{value:e.this_options,callback:function(t){e.this_options=t},expression:"this_options"}},e._l(e.options,function(e){return o("el-tab-pane",{key:e.entity.id,staticStyle:{height:"100%"},attrs:{label:e.entity.alias,name:String(e.entity.id)}})}),1)],1),o("el-container",["306"==e.this_options?o("zlfwqgl306"):e._e(),"307"==e.this_options?o("wggl307"):e._e(),"308"==e.this_options?o("msgl308"):e._e(),"361"==e.this_options?o("msgl361"):e._e()],1)],1)},a=[],l=o("a78e"),s=o.n(l),n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{height:"100%",width:"100%"}},[o("el-container",{staticStyle:{height:"100%"}},[o("el-header",{staticClass:"elheader"},[o("div",{staticClass:"leftbox"},[o("span",[e._v("服务器")])]),o("div",{staticClass:"rightbox"},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.refreshclick}},[e._v("刷新")]),o("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.inquireclick}},[e._v("事件查询")])],1)]),o("el-main",{staticClass:"elmainbox"},[o("Pub-Tabel",{attrs:{tableloading:e.tableloading,is_indx:!0,gridData:e.gridData,total_kp:e.total_kp,page_kp:e.page_kp,rows_kp:e.rows_kp,is_pagination:!0},on:{dialoghandleSize:e.dialoghandleSize,dialoghandleCurrent:e.dialoghandleCurrent,openDetails:e.openDetails}})],1)],1),o("Dialog-Tabel",{attrs:{dialogTableVisible:e.dialogTableVisible,gridData:e.DialogTabelData,rows_kp:e.Dialogrows_kp,total_kp:e.Dialogtotal_kp,cols:e.cols,loading:e.loading,noclick:!0},on:{Visible:e.Visible,dialoghandleSize:e.dialoghandleSize_Tabel,dialoghandleCurrent:e.dialoghandleCurrent_Tabel}})],1)},c=[],r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{height:"100%"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableloading,expression:"tableloading"}],ref:"tables",staticStyle:{width:"100%"},attrs:{data:e.gridData,border:"",height:"93%","row-class-name":e.tableRowClassName,"row-style":e.selectedHighlight},on:{"row-click":e.openDetails,"selection-change":e.handleSelectionChange,select:e.select,"select-all":e.selectall}},[e.selection?o("el-table-column",{attrs:{type:"selection",width:"40"}}):e._e(),e.is_indx?o("el-table-column",{attrs:{label:"序号","show-overflow-tooltip":!0,width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.$index+(1*e.page_kp-1)*(1*e.rows_kp)+1)+" ")])]}}])}):e._e(),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"servername",label:"服务器名称"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"serverip",label:"ip地址"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"serverport",label:"端口"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"serverdomain",label:"域名"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"serverstate",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return["正常"==t.row.serverstate?o("span",{staticClass:"ps"},[e._v(e._s(t.row.serverstate))]):o("span",{staticClass:"px"},[e._v(e._s(t.row.serverstate))])]}}])}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"servercpu",label:"CPU占用率"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"servermemory",label:"内存占用率"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"serverdate",label:"最近通讯时间"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"serveros",label:"操作系统"}})],1),e.is_pagination?o("el-pagination",{attrs:{"current-page":e.currentPage1,background:"","page-sizes":[15,20,30,40,50],"page-size":e.rows_kp,layout:"total, sizes, prev, pager, next, jumper",total:e.total_kp},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},d=[],u=(o("cadf"),o("551c"),o("097d"),{props:["gridData","rows_kp","page_kp","total_kp","cols","is_searchbox","selection","tableloading","selectdata","is_select","butsload","checkedload","is_pagination","is_indx","buttoms"],data:function(){return{getIndex:"",currentPage1:1,input21:"",iscardchecked:!1,isfingerchecked:!1,selectvalue:"",this_row:{}}},computed:{},watch:{selectvalue:function(e){this.$emit("selectvalue",e)}},mounted:function(){},methods:{is_agtype:function(e){return"1"==e?"宿舍区域":"2"==e?"公共区域":"3"==e?"随房间属性":void 0},is_buildtype:function(e){return"1"==e?"园区":"2"==e?"楼栋":"3"==e?"楼层":"4"==e?"房间":"5"==e?"楼梯":"6"==e?"装饰间":"7"==e?"门禁":void 0},scecountclick:function(e,t){this.$emit("scecountclick",e,t)},selectall:function(e){this.$emit("selectall",e)},selectedHighlight:function(e){e.row;var t=e.rowIndex;if(this.getIndex===t)return{"background-color":"#CAE1FF"}},tableRowClassName:function(e){var t=e.row,o=e.rowIndex;t.index=o},handleSelectionChange:function(e){this.$emit("handleSelectionChange",e)},select:function(e,t){this.$emit("select",e,t,this.$refs)},openDetails:function(e,t){this.getIndex=e.index,this.$emit("openDetails",e)},handleSizeChange:function(e){this.$emit("dialoghandleSize",e)},handleCurrentChange:function(e){this.$emit("dialoghandleCurrent",e)}}}),g=u,h=(o("f9ce"),o("2877")),f=Object(h["a"])(g,r,d,!1,null,"8cedb69e",null);f.options.__file="table306.vue";var p=f.exports,m=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{attrs:{title:e.title,visible:e.dialogTableVisible,"before-close":e.handleDialogClose,width:"1100px","append-to-body":""},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box",staticStyle:{width:"100%"},attrs:{data:e.gridData,border:"",height:"400px"},on:{"selection-change":e.handleSelectionChange}},e._l(e.cols,function(t,i){return o("el-table-column",{key:i,attrs:{prop:t.prop,label:t.label,border:"","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(i){return["roomstate"==t.prop?o("div",["正常"==i.row.roomstate?o("p",{staticClass:"cg1"},[e._v(e._s(i.row.roomstate)+"22")]):o("p",{staticClass:"cg2"},[e._v(e._s(i.row.roomstate)+"11")])]):o("span",[e._v(e._s(i.row[t.prop]))])]}}])})}),1),e.is_elpagination?o("el-pagination",{attrs:{"current-page":e.currentPage1,background:"","page-sizes":[15,20,30,40,50],"page-size":e.rows_kp,layout:"total, sizes, prev, pager, next, jumper",total:e.total_kp},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e(),o("div",{staticClass:"divs"})],1)],1)},b=[],v={props:["dialogTableVisible","gridData","cols","title","rows_kp","total_kp","loading","is_handleClick","is_elpagination"],data:function(){return{currentPage1:1,selectionarr:[]}},watch:{dialogTableVisible:function(e){0==e&&(this.selectionarr=[])}},mounted:function(){},methods:{deleteClick:function(e){this.$emit("deleteClick",e)},handleClick:function(e){this.$emit("handleClick",e)},handleSizeChange:function(e){console.log("每页 ".concat(e," 条")),this.$emit("dialoghandleSize",e)},handleCurrentChange:function(e){console.log("当前页: ".concat(e)),this.$emit("dialoghandleCurrent",e)},handleDialogClose:function(){this.$emit("Visible",!1)},handleSelectionChange:function(e){console.log(e),this.selectionarr=e},Refresh:function(){var e=this.$store.getters.getzwgl230Refreshtable;e=!e,this.$store.commit("setzwgl230Refreshtable",e)}}},w=v,_=(o("1ea4"),Object(h["a"])(w,m,b,!1,null,"0b100c84",null));_.options.__file="DialogTabel.vue";var y=_.exports,k={data:function(){return{serverid:"",dialogTableVisible:!1,DialogTabelData:[],Dialogrows_kp:15,Dialogpage_kp:1,Dialogtotal_kp:0,tableloading:!1,loading:!1,cols:[{prop:"servername",label:"服务器名称"},{prop:"slcontent",label:"事件类型"},{prop:"sldate",label:"时间点"}],gridData:[],rows_kp:15,page_kp:1,total_kp:0}},components:{PubTabel:p,DialogTabel:y},computed:{},mounted:function(){this.getnextbuild()},methods:{Visible:function(){this.dialogTableVisible=!1},openDetails:function(e){console.log(e),this.serverid=e.serverid},refreshclick:function(){this.getnextbuild()},dialoghandleSize_Tabel:function(e){this.Dialogrows_kp=e,this.getserverinfo()},dialoghandleCurrent_Tabel:function(e){this.Dialogpage_kp=e,this.getserverinfo()},inquireclick:function(){""!=this.serverid?(this.dialogTableVisible=!0,this.getserverinfo()):this.$message({message:"请先中要查看的服务器",type:"warning"})},getserverinfo:function(){var e=this;this.loading=!0;var t=s.a.get("token");this.$post("/system/device/orderserver/2/getserverinfo?token=".concat(t),{serverid:this.serverid,page:this.Dialogpage_kp,rows:this.Dialogrows_kp}).then(function(t){console.log(t.result),e.DialogTabelData=t.result.data,e.Dialogtotal_kp=1*t.result.total,e.loading=!1}).catch(function(t){console.log(t),e.loading=!1})},getnextbuild:function(){var e=this;this.tableloading=!0;var t=s.a.get("token");this.$post("/system/device/orderserver/1/getserver?token=".concat(t),{page:this.page_kp,rows:this.rows_kp}).then(function(t){console.log(t.result),e.gridData=t.result.data,e.total_kp=1*t.result.total,e.tableloading=!1}).catch(function(t){console.log(t),e.tableloading=!1})},dialoghandleCurrent:function(e){this.page_kp=e,this.getnextbuild()},dialoghandleSize:function(e){this.rows_kp=e,this.getnextbuild()}}},C=k,x=(o("fef2"),Object(h["a"])(C,n,c,!1,null,"556c6f2e",null));x.options.__file="zlfwqgl306.vue";var D=x.exports,$=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading_pages,expression:"loading_pages"}],staticClass:"libox",attrs:{"element-loading-text":"下发中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[o("el-container",{staticClass:"el-containerbox"},[o("el-aside",{staticClass:"leftbox",staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"210px"}},[o("trees",{ref:"trees_Component",attrs:{TreeURL:"/system/device/gateway/1/getbuildtree",Props:e.Props,addbuildingbutid:e.addbuildingbutid},on:{handleNodeClick:e.handleNodeClick}})],1),o("el-container",{staticClass:"mins"},[o("el-header",{staticClass:"elheader"},[o("div",{staticClass:"titlebox"},[e._v(e._s(e.fatheragid.buildlocation)+"(区域编号"+e._s(e.fatheragid.buildcode)+")")]),o("div",{staticClass:"heads rights"},[o("el-input",{attrs:{placeholder:"请输入唯一ID/通讯ID搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)]),o("el-main",[o("Pub-Tabel",{attrs:{tableloading:e.tableloading,buttoms:e.buttoms,selection:!0,is_indx:!0,gridData:e.gridData,total_kp:e.total_kp,page_kp:e.page_kp,rows_kp:e.rows_kp,is_pagination:!0},on:{dialoghandleSize:e.dialoghandleSize,dialoghandleCurrent:e.dialoghandleCurrent,scecountclick:e.scecountclick,msclick:e.msclick,select:e.select,selectall:e.selectall}})],1),o("el-footer",{staticClass:"elfooter"},[o("div",{staticClass:"elfooterleftbox"},[o("el-select",{staticClass:"select_fw",attrs:{size:"small"},model:{value:e.value_fw,callback:function(t){e.value_fw=t},expression:"value_fw"}},[o("el-option",{attrs:{label:"勾选范围",value:"勾选范围"}}),o("el-option",{attrs:{label:"区域范围",value:"区域范围"}})],1),e.bus.length>0?[o("el-select",{staticClass:"select_zl",attrs:{size:"small",placeholder:"请选择需下发的指令"},model:{value:e.value_zl,callback:function(t){e.value_zl=t},expression:"value_zl"}},e._l(e.bus,function(e){return o("el-option",{key:e.entity.alias,attrs:{label:e.entity.alias,value:e.entity.id}})}),1),o("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return e.csclick(t)}}},[e._v("开始下发")])]:e._e()],2),e._l(e.foortbuts,function(t,i){return[o("el-button",{key:t.entity.id,attrs:{type:"primary",size:"small"},nativeOn:{click:function(o){e.buttonclick(t.entity.id,o)}}},[e._v(e._s(t.entity.alias))])]})],2),o("Dialog-Tabel",{attrs:{dialogTableVisible:e.dialogTableVisible,gridData:e.dialogTablegridData,cols:e.dialogTablecols,title:"绑定门锁详情"},on:{handleDialogClose:e.setdialogFormVisible,Visible:e.dialogTableVisibleClose}}),o("addbuilding",{attrs:{dialogFormVisible:e.addbuildingVisible,buildinginfo:e.fatheragid,butid:e.addbuildingbutid},on:{handleDialogClose:e.addbuildingVisibleClose,refresh:e.refresh}}),o("modification",{attrs:{dialogFormVisible:e.modificationVisible,buildinginfo:e.gateway,butid:e.addbuildingbutid},on:{refresh:e.refresh,handleDialogClose:e.modificationVisibleClose}})],1)],1)],1)},V=[],S=(o("386d"),o("a4bb")),z=o.n(S),I=o("f499"),T=o.n(I),F=o("d4e7"),R=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{height:"100%"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableloading,expression:"tableloading"}],ref:"tables",staticStyle:{width:"100%"},attrs:{data:e.gridData,border:"",height:"93%","row-class-name":e.tableRowClassName,"row-style":e.selectedHighlight},on:{"row-click":e.openDetails,"selection-change":e.handleSelectionChange,select:e.select,"select-all":e.selectall}},[e.selection?o("el-table-column",{attrs:{type:"selection",width:"40"}}):e._e(),e.is_indx?o("el-table-column",{attrs:{label:"序号","show-overflow-tooltip":!0,width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.$index+(1*e.page_kp-1)*(1*e.rows_kp)+1)+" ")])]}}])}):e._e(),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"gatewaylocation",label:"网关位置",width:"200"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"gatewaytype",label:"网关型号"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"gatewaycode2",label:"网关唯一ID"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"gatewaycode",label:"网关通讯ID"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"gatewaystate",label:"通讯状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{class:"正常"==t.row.gatewaystate?"puc-ps":"puc-px"},[e._v(e._s(t.row.gatewaystate))])]}}])}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"gatewayip",label:"IP地址"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"lockcount",label:"绑定门锁",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{class:t.row.lockcount>0?"puc-ps-pointer":"",on:{click:function(o){o.stopPropagation(),e.msclick(t.row)}}},[e._v(e._s(t.row.lockcount))])]}}])}),o("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.buttomsbj,function(i){return o("span",{key:i.entity.id,staticClass:"bjbox",on:{click:function(o){o.stopPropagation(),e.scecountclick(i.entity.id,t.row)}}},[36==i.entity.id?o("i",{staticClass:"el-icon-setting"}):e._e()])})}}])})],1),e.is_pagination?o("el-pagination",{attrs:{"current-page":e.currentPage1,background:"","page-sizes":[15,20,30,40,50],"page-size":e.rows_kp,layout:"total, sizes, prev, pager, next, jumper",total:e.total_kp},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},L=[],U={props:["gridData","rows_kp","page_kp","total_kp","cols","is_searchbox","selection","tableloading","selectdata","is_select","butsload","checkedload","is_pagination","is_indx","buttoms"],data:function(){return{getIndex:"",currentPage1:1,input21:"",iscardchecked:!1,isfingerchecked:!1,selectvalue:"",this_row:{}}},computed:{buttomsbj:function(){var e=this.buttoms;return e.length>0?e:[]}},watch:{selectvalue:function(e){this.$emit("selectvalue",e)}},mounted:function(){},methods:{is_agtype:function(e){return"1"==e?"宿舍区域":"2"==e?"公共区域":"3"==e?"随房间属性":void 0},is_buildtype:function(e){return"1"==e?"园区":"2"==e?"楼栋":"3"==e?"楼层":"4"==e?"房间":"5"==e?"楼梯":"6"==e?"装饰间":"7"==e?"门禁":void 0},scecountclick:function(e,t){this.$emit("scecountclick",e,t)},msclick:function(e){this.$emit("msclick",e)},selectall:function(e){this.$emit("selectall",e)},selectedHighlight:function(e){e.row;var t=e.rowIndex;if(this.getIndex===t)return{"background-color":"#CAE1FF"}},tableRowClassName:function(e){var t=e.row,o=e.rowIndex;t.index=o},handleSelectionChange:function(e){this.$emit("handleSelectionChange",e)},select:function(e,t){this.$emit("select",e,t,this.$refs)},openDetails:function(e,t){this.getIndex=e.index,this.$emit("openDetails",e)},handleSizeChange:function(e){this.$emit("dialoghandleSize",e)},handleCurrentChange:function(e){this.$emit("dialoghandleCurrent",e)}}},P=U,N=(o("6d72"),Object(h["a"])(P,R,L,!1,null,"7c832cb0",null));N.options.__file="PubTabel.vue";var M=N.exports,j=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{attrs:{title:e.title,visible:e.dialogFormVisible,"close-on-click-modal":!1,"before-close":e.handleDialogClose,width:"360px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-container",[o("el-container",[o("div",{staticClass:"frombox"},[o("el-form",{attrs:{"label-position":e.labelPosition,"label-width":"105px"}},[o("el-form-item",{attrs:{label:"网关位置:"}},[o("span",[e._v(e._s(e.buildinginfo.buildlocation))])]),o("el-form-item",{attrs:{label:"新增网关数量:"}},[o("el-input",{staticClass:"inputs",model:{value:e.form.gatewaycount,callback:function(t){e.$set(e.form,"gatewaycount",t)},expression:"form.gatewaycount"}})],1),o("el-form-item",{attrs:{label:"起始网关编号:"}},[o("el-input",{staticClass:"inputs",model:{value:e.startcode,callback:function(t){e.startcode=t},expression:"startcode"}})],1),o("el-form-item",{attrs:{label:"网关类型:"}},[o("el-select",{staticClass:"inputs",attrs:{clearable:"",placeholder:"请选择"},model:{value:e.value_lx,callback:function(t){e.value_lx=t},expression:"value_lx"}},e._l(e.gatewaytype,function(e){return o("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),o("el-form-item",{attrs:{label:"网关通讯ID:"}},[o("span",[e._v(e._s(e.gatewaycode))])]),o("el-form-item",{attrs:{label:"网关唯一ID:"}},[o("el-input",{staticClass:"inputs",model:{value:e.form.gatewaycode2,callback:function(t){e.$set(e.form,"gatewaycode2",t)},expression:"form.gatewaycode2"}})],1)],1)],1)])],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.addbuilding}},[e._v("确定新增")])],1)],1)],1)},E=[],O={components:{},props:["dialogFormVisible","butid","buildinginfo"],data:function(){return{gatewaytype:[],roomtype:"",title:"",labelPosition:"right",value_lx:"",gatewaycode:"",startcode:"1",form:{gatewaycount:"1",gatewaycode2:""},fatheragid:{}}},computed:{subset:function(){if(this.dialogFormVisible)return!this.buildinginfo.hasOwnProperty("sequence")}},mounted:function(){},watch:{dialogFormVisible:function(e){e&&(console.log(this.butid),this.getsavegate())},startcode:function(e){this.getsavegate()}},methods:{addbuilding:function(){var e=this,t=s.a.get("token"),o=this.gatewaycode,i=this.form.gatewaycode2,a=this.form.gatewaycount,l=this.value_lx,n=this.startcode,c="/system/device/gateway/save/2/savegateway";this.$post("".concat(c,"?token=").concat(t,"&gatewaycode=").concat(o,"&gatewaycode2=").concat(i,"&gatewaycount=").concat(a,"&gatewaytype=").concat(l,"&startcode=").concat(n),this.buildinginfo,"1").then(function(t){console.log(t.result),e.$message({showClose:!0,message:"网关添加成功",type:"success"}),e.handleDialogClose(),e.refresh()}).catch(function(t){console.log(t),e.$message({showClose:!0,message:t.resultMsg||"连接失败",type:"warning"})})},refresh:function(){this.$emit("refresh")},getsavegate:function(){var e=this,t=s.a.get("token"),o=this.startcode;""==this.startcode&&(o="1");var i="/system/device/gateway/save/1/getsavegatewayinfo";this.$post("".concat(i,"?token=").concat(t,"&startcode=").concat(o),this.buildinginfo,"1").then(function(t){console.log("获取网关信息",t.result),e.gatewaycode=t.result.gatewaycode,e.gatewaytype=t.result.gatewaytype}).catch(function(t){console.log(t),e.$message({showClose:!0,message:t.resultMsg||"连接失败",type:"warning"})})},handleDialogClose:function(){this.$emit("handleDialogClose"),this.form.gatewaycount="1",this.startcode="1",this.form.gatewaycode2="",this.value_lx="",this.fatheragid={}}}},A=O,B=(o("07d4"),Object(h["a"])(A,j,E,!1,null,"1b04fe2e",null));B.options.__file="addbuilding.vue";var H=B.exports,q=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{attrs:{title:"管理网关",visible:e.dialogFormVisible,"close-on-click-modal":!1,"before-close":e.handleDialogClose,width:"1000px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{staticClass:"formbox",attrs:{"label-width":"120px"}},[o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"网关位置"}},[o("span",[e._v(e._s(e.buildinginfo.gatewaylocation))])]),o("el-form-item",{attrs:{label:"网关编号"}},[o("span",[e._v(e._s(e.updategatewayinfo.gatewayseq))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"网关型号"}},[o("el-select",{staticClass:"inputs",attrs:{"value-key":"value"},model:{value:e.region,callback:function(t){e.region=t},expression:"region"}},e._l(e.gatewaytypes,function(e){return o("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),o("el-form-item",{attrs:{label:"软件版本号"}},[o("span",[e._v(e._s(e.updategatewayinfo.ver))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"网关唯一ID"}},[o("span",[e._v(e._s(e.updategatewayinfo.gatewaycode2))])]),o("el-form-item",{attrs:{label:"新网关唯一ID"}},[o("el-input",{staticClass:"inputs",attrs:{placeholder:"不填为不修改"},model:{value:e.gatewaycode2,callback:function(t){e.gatewaycode2=t},expression:"gatewaycode2"}})],1)],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"网关功率"}},[o("span",[e._v(e._s(e.updategatewayinfo.power))])]),o("el-form-item",{attrs:{label:"信号ID"}},[o("span",[e._v(e._s(e.updategatewayinfo.xdid))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"信号"}},[o("span",[e._v(e._s(e.updategatewayinfo.xd))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"通讯ID"}},[o("span",[e._v(e._s(e.updategatewayinfo.gatewaycode))])])],1)]),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.determine}},[e._v("确 定 修 改")])],1)],1)],1)},J=[],Y={props:["dialogFormVisible","buildinginfo"],data:function(){return{gatewaycode2:"",region:"",updategatewayinfo:{},gatewaytypes:[]}},watch:{dialogFormVisible:function(e){console.log(this.buildinginfo),e&&this.getupdategatewayinfo()}},components:{},computed:{},mounted:function(){},methods:{determine:function(){this.updategateway()},handleDialogClose:function(){this.$emit("handleDialogClose"),this.gatewaycode2="",this.region=""},getupdategatewayinfo:function(){var e=this,t=s.a.get("token"),o=this.buildinginfo.gatewaycode;this.$post("/system/device/gateway/update/1/getupdategatewayinfo",{gatewaycode:o,token:t}).then(function(t){console.log(t.result),e.updategatewayinfo=t.result,e.gatewaytypes=t.result.gatewaytypes,e.region=t.result.gatewaytype}).catch(function(t){console.log(t),e.$message.error(t.resultMsg||"连接失败")})},refresh:function(){this.$emit("refresh")},updategateway:function(){var e=this,t=s.a.get("token");this.$post("/system/device/gateway/update/2/updategateway?token=".concat(t),{gatewaycode:this.buildinginfo.gatewaycode,gatewaytype:this.region,newgatewaycode2:this.gatewaycode2}).then(function(t){console.log(t.result),e.$message({message:"修改网关成功",type:"success"}),e.handleDialogClose(),e.refresh()}).catch(function(t){console.log(t),e.$message.error(t.resultMsg||"连接失败")})}}},G=Y,K=(o("d5f3"),Object(h["a"])(G,q,J,!1,null,"2342fa47",null));K.options.__file="modification.vue";var Q=K.exports,W=(o("fa7d"),{components:{trees:F["a"],PubTabel:M,DialogTabel:y,addbuilding:H,modification:Q},data:function(){return{loading_pages:!1,dialogTableVisible:!1,dialogTablegridData:[],dialogTablecols:[{prop:"roomcode",label:"门锁通讯ID"},{prop:"roomcode2",label:"门锁唯一ID"},{prop:"roomlocation",label:"门锁位置"},{prop:"roommodel",label:"门锁型号"},{prop:"roomstate",label:"门锁状态"}],gateway:{},value_fw:"勾选范围",value_zl:"",Selectedinformation:[],modificationinfo:{},modificationVisible:!1,addbuildingbutid:"",dialogFormVisible:!1,tableloading:!1,addbuildingVisible:!1,pagesid:307,bus:[],fatheragid:{},fatheragid_xj:{},gridData:[],foortbuts:[],total_kp:0,search:"",rows_kp:15,page_kp:1,buttoms:[],Props:{children:"children",label:"buildname",isLeaf:function(e,t){var o=JSON.parse(T()(e));return 1==o.isnext?o.isnext=!1:o.isnext=!0,o.isnext}}}},computed:{},mounted:function(){this.getsonmenu(),this.getnextbuild()},methods:{csclick:function(){console.log(this.value_zl),0!=this.Selectedinformation.length?""!=this.value_zl?(this.loading_pages=!0,172==this.value_zl?this.savegatewayorder("状态查询"):177==this.value_zl?this.savegatewayorder("更新网关路由"):188==this.value_zl?this.savegatewayorder("更新射频功率"):200==this.value_zl&&this.savegatewayorder("初始化网关ID")):this.$message({showClose:!0,message:"请先选择要下发的指令",type:"warning"}):this.$message({showClose:!0,message:"请先勾选网关",type:"warning"})},savegatewayorder:function(e){var t=this,o=s.a.get("token"),i=this.fatheragid.buildid,a=[];this.Selectedinformation.map(function(e){a.push(e.gatewaycode)});var l=this.value_fw,n=e,c="a0";console.log("buildid",i),console.log("gatewaycode",a),console.log("gotype",l),console.log("gotype2",n),console.log("power",c),console.log(o),this.$post("/system/device/gateway/order/1/savegatewayorder?token=".concat(o,"&buildid=").concat(i,"&gotype=").concat(l,"&gotype2=").concat(n,"&power=").concat(c),a,"1").then(function(e){console.log(e.result),t.loading_pages=!1,t.$message({message:"指令下发成功",type:"success"}),t.getnextbuild()}).catch(function(e){console.log(e),t.loading_pages=!1,t.$message.error(e.resultMsg||"连接失败")})},dialogTableVisibleClose:function(){this.dialogTableVisible=!1},msclick:function(e){console.log(e),this.dialogTableVisible=!0,this.getlock(e)},select:function(e){console.log(e),this.Selectedinformation=e},selectall:function(e){console.log(e),this.Selectedinformation=e},modificationVisibleClose:function(){console.log("关闭11"),this.modificationVisible=!1,console.log(this.modificationVisible)},refresh:function(){this.getnextbuild()},addbuildingVisibleClose:function(){this.addbuildingVisible=!1},setdialogFormVisible:function(){this.dialogFormVisible=!1},buttonclick:function(e){var t=this;if(console.log(e),35==e){if(0==z()(this.fatheragid).length)return void this.$message({showClose:!0,message:"请先选中左侧区域",type:"warning"});if(3!=this.fatheragid.buildtype)return void this.$message({showClose:!0,message:"网关位置必须为楼层!",type:"warning"});this.addbuildingVisible=!0,this.addbuildingbutid=e}else if(36==e){if(0==this.Selectedinformation.length)return void this.$message({showClose:!0,message:"请先勾选网关",type:"warning"});this.modificationVisible=!0,this.addbuildingbutid=e}else if(37==e){if(console.log(this.Selectedinformation),0==this.Selectedinformation.length)return void this.$message({showClose:!0,message:"请勾选中要删除的网关",type:"warning"});this.$confirm("此操作将删除勾选中的网关, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.updatebuild()})}},updatebuild:function(){var e=this,t=s.a.get("token"),o=[];this.Selectedinformation.map(function(e){o.push(e.gatewaycode)}),this.$post("/system/device/gateway/delete/1/deletegateway?token=".concat(t),o,"1").then(function(t){console.log(t.result),e.$message({message:"删除网关成功",type:"success"}),e.getnextbuild()}).catch(function(t){console.log(t),e.$message.error(t.resultMsg||"连接失败")})},scecountclick:function(e,t){console.log(e,t),36==e&&(this.modificationVisible=!0,this.gateway=t)},dialoghandleCurrent:function(e){this.page_kp=e,this.getnextbuild()},dialoghandleSize:function(e){this.rows_kp=e,this.getnextbuild()},handleNodeClick:function(e){console.log(e),this.fatheragid=e,this.getnextbuild()},getsonmenu:function(){var e=this,t=s.a.get("token");this.$post("/login/home/2/getsonmenu",{token:t,fatherid:this.pagesid}).then(function(t){console.log(t.result),e.buttoms=t.result;var o=[],i=[];t.result.map(function(t){172!=t.entity.id&&177!=t.entity.id&&188!=t.entity.id&&200!=t.entity.id||(e.glybut=!0,i.push(t)),178!=t.entity.id&&35!=t.entity.id&&36!=t.entity.id&&37!=t.entity.id&&32!=t.entity.id||o.push(t),e.foortbuts=o,e.bus=i})}).catch(function(e){console.log(e)})},getnextbuild:function(){var e=this;this.tableloading=!0;var t=s.a.get("token");this.$post("/system/device/gateway/2/getgateway?token=".concat(t,"&page=").concat(this.page_kp,"&rows=").concat(this.rows_kp,"&search=").concat(this.search),this.fatheragid,"1").then(function(t){console.log(t.result),e.gridData=t.result.data,e.total_kp=1*t.result.total,e.tableloading=!1}).catch(function(t){console.log(t),e.tableloading=!1})},getlock:function(e){var t=this,o=s.a.get("token");this.$post("/system/device/gateway/info/1/getlock",{token:o,gatewaycode:e.gatewaycode}).then(function(e){console.log(e.result),t.dialogTablegridData=e.result}).catch(function(e){console.log(e)})}},watch:{search:function(e){console.log(e),this.Selectedinformation=[],this.getnextbuild()}}}),X=W,Z=(o("6a99c"),Object(h["a"])(X,$,V,!1,null,"73fef590",null));Z.options.__file="wggl307.vue";var ee=Z.exports,te=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading_pages,expression:"loading_pages"}],staticClass:"libox",attrs:{"element-loading-text":"下发中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[o("el-container",{staticClass:"el-containerbox"},[o("el-aside",{staticClass:"leftbox",staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"210px"}},[o("trees",{ref:"trees_Component",attrs:{TreeURL:"/system/device/devicelock/1/getbuildtree",Props:e.Props,addbuildingbutid:e.addbuildingbutid},on:{handleNodeClick:e.handleNodeClick}})],1),o("el-container",{staticClass:"mins"},[o("el-header",{staticClass:"elheader"},[o("div",{staticClass:"titlebox"},[e._v(e._s(e.fatheragid.buildlocation)+"(区域编号"+e._s(e.fatheragid.buildcode)+")")]),o("div",{staticClass:"heads rights"},[o("el-input",{staticClass:"inpts",attrs:{size:"small",placeholder:"请输入唯一ID/通讯ID搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._l(e.topbut,function(t,i){return[o("el-button",{key:t.entity.id,attrs:{type:"primary",size:"small"},nativeOn:{click:function(o){e.xz_click(t.entity.id,o)}}},[e._v(e._s(t.entity.alias))])]})],2)]),o("el-main",[o("Pub-Tabel",{attrs:{tableloading:e.tableloading,buttoms:e.buttoms,selection:!0,is_indx:!0,gridData:e.gridData,total_kp:e.total_kp,page_kp:e.page_kp,rows_kp:e.rows_kp,is_pagination:!0},on:{dialoghandleSize:e.dialoghandleSize,dialoghandleCurrent:e.dialoghandleCurrent,openDetails:e.openDetails,msclick:e.msclick,select:e.select,selectall:e.selectall}})],1),o("el-footer",{staticClass:"elfooter"},[o("div",{staticClass:"elfooterleftbox"},[o("el-select",{staticClass:"select_fw",attrs:{size:"small"},model:{value:e.value_fw,callback:function(t){e.value_fw=t},expression:"value_fw"}},[o("el-option",{attrs:{label:"勾选范围",value:"勾选范围"}}),o("el-option",{attrs:{label:"区域范围",value:"区域范围"}})],1),e.bus.length>0?[o("el-select",{staticClass:"select_zl",attrs:{size:"small",placeholder:"请选择需下发的指令"},model:{value:e.value_zl,callback:function(t){e.value_zl=t},expression:"value_zl"}},e._l(e.bus,function(e){return o("el-option",{key:e.entity.alias,attrs:{label:e.entity.alias,value:e.entity.id}})}),1),e._l(e.bus_gg,function(t,i){return[o("el-button",{key:t.entity.id,attrs:{type:"primary",size:"small"},nativeOn:{click:function(o){e.ks_click(t.entity.id,o)}}},[e._v(e._s(t.entity.alias))])]})]:e._e()],2),e._l(e.foortbuts,function(t,i){return[o("el-button",{key:t.entity.id,attrs:{type:"primary",size:"small"},nativeOn:{click:function(o){e.buttonclick(t.entity.id,o)}}},[e._v(e._s(t.entity.alias))])]})],2),o("Dialog-Tabel",{attrs:{dialogTableVisible:e.dialogTableVisible,gridData:e.dialogTablegridData,cols:e.dialogTablecols,title:"绑定门锁详情"},on:{handleDialogClose:e.setdialogFormVisible,Visible:e.dialogTableVisibleClose}}),o("addbuilding",{attrs:{dialogFormVisible:e.addbuildingVisible,buildinginfo:e.fatheragid,butid:e.addbuildingbutid},on:{handleDialogClose:e.addbuildingVisibleClose,refresh:e.refresh}}),o("modification",{attrs:{dialogFormVisible:e.modificationVisible,buildinginfo:e.gateway,butid:e.addbuildingbutid},on:{refresh:e.refresh,handleDialogClose:e.modificationVisibleClose}})],1),o("dialog-File",{attrs:{FileimportVisible:e.FileimportVisible,title:"设备列表导入",uploadURL:e.uploadURL,downloadURL:e.downloadURL},on:{handleDialogClose:e.handleDialogClose}})],1)],1)},oe=[],ie=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{height:"100%"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableloading,expression:"tableloading"}],ref:"tables",staticStyle:{width:"100%"},attrs:{data:e.gridData,border:"",height:"93%","row-class-name":e.tableRowClassName,"row-style":e.selectedHighlight},on:{"row-click":e.openDetails,"selection-change":e.handleSelectionChange,select:e.select,"select-all":e.selectall}},[e.selection?o("el-table-column",{attrs:{type:"selection",width:"40"}}):e._e(),e.is_indx?o("el-table-column",{attrs:{label:"序号","show-overflow-tooltip":!0,width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.$index+(1*e.page_kp-1)*(1*e.rows_kp)+1)+" ")])]}}])}):e._e(),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"roomlocation",label:"门锁位置",width:"200"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"roomcode",label:"门锁通讯ID"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"roommodel",label:"门锁型号"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"roomcode2",label:"门锁唯一ID"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"roomstate",label:"通讯状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{class:"通讯正常"==t.row.roomstate?"puc-ps":"puc-px"},[e._v(e._s(t.row.roomstate))])]}}])}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"gatewaytype",label:"网关型号"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"gatewaycode",label:"网关唯一ID"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"gatewaycode2",label:"网关唯一ID"}})],1),e.is_pagination?o("el-pagination",{attrs:{"current-page":e.currentPage1,background:"","page-sizes":[15,20,30,40,50],"page-size":e.rows_kp,layout:"total, sizes, prev, pager, next, jumper",total:e.total_kp},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},ae=[],le={props:["gridData","rows_kp","page_kp","total_kp","cols","is_searchbox","selection","tableloading","selectdata","is_select","butsload","checkedload","is_pagination","is_indx","buttoms"],data:function(){return{getIndex:"",currentPage1:1,input21:"",iscardchecked:!1,isfingerchecked:!1,selectvalue:"",this_row:{}}},computed:{buttomsbj:function(){var e=this.buttoms;return e.length>0?e:[]}},watch:{selectvalue:function(e){this.$emit("selectvalue",e)}},mounted:function(){},methods:{is_agtype:function(e){return"1"==e?"宿舍区域":"2"==e?"公共区域":"3"==e?"随房间属性":void 0},is_buildtype:function(e){return"1"==e?"园区":"2"==e?"楼栋":"3"==e?"楼层":"4"==e?"房间":"5"==e?"楼梯":"6"==e?"装饰间":"7"==e?"门禁":void 0},scecountclick:function(e,t){this.$emit("scecountclick",e,t)},msclick:function(e){this.$emit("msclick",e)},selectall:function(e){this.$emit("selectall",e)},selectedHighlight:function(e){e.row;var t=e.rowIndex;if(this.getIndex===t)return{"background-color":"#CAE1FF"}},tableRowClassName:function(e){var t=e.row,o=e.rowIndex;t.index=o},handleSelectionChange:function(e){this.$emit("handleSelectionChange",e)},select:function(e,t){this.$emit("select",e,t,this.$refs)},openDetails:function(e,t){this.getIndex=e.index,this.$emit("openDetails",e)},handleSizeChange:function(e){this.$emit("dialoghandleSize",e)},handleCurrentChange:function(e){this.$emit("dialoghandleCurrent",e)}}},se=le,ne=(o("3129"),Object(h["a"])(se,ie,ae,!1,null,"f63b6d1e",null));ne.options.__file="PubTabel1.vue";var ce=ne.exports,re=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{attrs:{title:"管理门锁",visible:e.dialogFormVisible,"close-on-click-modal":!1,"before-close":e.handleDialogClose,width:"700px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{staticClass:"formbox",attrs:{"label-width":"100px","label-position":"left"}},[o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"房间位置"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomlocation))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"通讯ID"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomcode))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"门锁型号"}},[o("el-select",{staticClass:"inputs",attrs:{"value-key":"value"},model:{value:e.region_roommodel,callback:function(t){e.region_roommodel=t},expression:"region_roommodel"}},e._l(e.roommodels,function(e){return o("el-option",{key:e.modelname,attrs:{label:e.modelname,value:e}})}),1)],1)],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"门锁唯一ID"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomcode2))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"新唯一ID"}},[o("el-input",{staticClass:"inputs",attrs:{placeholder:"不填为不修改"},model:{value:e.wyid,callback:function(t){e.wyid=t},expression:"wyid"}})],1)],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"电池电量"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomcharge))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"软件版本号"}},[o("span",[e._v(e._s(e.updategatewayinfo.lockver))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"信道ID"}},[o("span",[e._v(e._s(e.updategatewayinfo.channelid))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"信道"}},[o("span",[e._v(e._s(e.updategatewayinfo.channel))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"通讯功率"}},[o("span",[e._v(e._s(e.updategatewayinfo.powerlev))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"最后通讯时间"}},[o("span",[e._v(e._s(e.updategatewayinfo.lastactivedate))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"分配网关"}},[o("el-select",{staticClass:"inputs",attrs:{"value-key":"value"},model:{value:e.region,callback:function(t){e.region=t},expression:"region"}},e._l(e.gatewaytypes,function(e){return o("el-option",{key:e.gatewaycode,attrs:{label:e.gatewaycode2,value:e.gatewaycode}})}),1)],1)],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"网关通讯ID"}},[o("span",[e._v(e._s(e.updategatewayinfo.gatewaycode))])])],1)]),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.determine}},[e._v("确 定 修 改")])],1)],1)],1)},de=[],ue={props:["dialogFormVisible","buildinginfo"],data:function(){return{region_roommodel:"",gatewaycode2:"",region:"",roommodels:[],updategatewayinfo:{},gatewaytypes:[],wyid:""}},watch:{dialogFormVisible:function(e){console.log(this.buildinginfo),e&&this.getupdategatewayinfo()}},components:{},computed:{},mounted:function(){},methods:{determine:function(){this.updategateway()},handleDialogClose:function(){this.$emit("handleDialogClose"),this.gatewaycode2="",this.region=""},getupdategatewayinfo:function(){var e=this,t=s.a.get("token"),o=this.buildinginfo.roomid;this.$post("/system/device/devicelock/update/1/getupdatedevicelockinfo",{roomid:o,token:t}).then(function(t){console.log(t.result),e.updategatewayinfo=t.result,e.gatewaytypes=t.result.gatewaycodes,e.roommodels=t.result.roommodels}).catch(function(t){console.log(t),e.$message.error(t.resultMsg||"连接失败")})},refresh:function(){this.$emit("refresh")},updategateway:function(){var e=this;console.log(this.updategatewayinfo),console.log("gatewaycode",this.updategatewayinfo.gatewaycode),console.log("wyid",this.wyid),console.log("roomid ",this.buildinginfo.roomid),console.log("roommodel ",this.region_roommodel);var t=s.a.get("token");this.$post("/system/device/devicelock/update/2/updatedevicelock?token=".concat(t,"&gatewaycode=").concat(this.buildinginfo.gatewaycode,"&roomcode2=").concat(this.wyid,"&roomid=").concat(this.buildinginfo.roomid),this.region_roommodel,"1").then(function(t){console.log(t.result),e.$message({message:"修改门锁成功",type:"success"}),e.handleDialogClose(),e.refresh()}).catch(function(t){console.log(t),e.$message.error(t.resultMsg||"连接失败")})}}},ge=ue,he=(o("8bf6"),Object(h["a"])(ge,re,de,!1,null,"37eb93e4",null));he.options.__file="modification1.vue";var fe=he.exports,pe=o("7232"),me={components:{trees:F["a"],PubTabel:ce,DialogTabel:y,addbuilding:H,modification:fe,dialogFile:pe["a"]},data:function(){return{uploadURL:"",downloadURL:"",FileimportVisible:!1,titles:"",topbut:[],bus_gg:[],loading_pages:!1,dialogTableVisible:!1,dialogTablegridData:[],dialogTablecols:[{prop:"roomcode",label:"门锁通讯ID"},{prop:"roomcode2",label:"门锁唯一ID"},{prop:"roomlocation",label:"门锁位置"},{prop:"roommodel",label:"门锁型号"},{prop:"roomstate",label:"门锁状态"}],gateway:{},value_fw:"勾选范围",value_zl:"",Selectedinformation:[],modificationinfo:{},modificationVisible:!1,addbuildingbutid:"",dialogFormVisible:!1,tableloading:!1,addbuildingVisible:!1,pagesid:308,bus:[],fatheragid:{},fatheragid_xj:{},gridData:[],foortbuts:[],total_kp:0,search:"",rows_kp:15,page_kp:1,buttoms:[],Props:{children:"children",label:"buildname",isLeaf:function(e,t){var o=JSON.parse(T()(e));return 1==o.isnext?o.isnext=!1:o.isnext=!0,o.isnext}}}},computed:{},mounted:function(){this.getsonmenu(),this.getnextbuild()},methods:{handleDialogClose:function(){this.FileimportVisible=!1},xz_click:function(e){console.log(e),354==e&&(console.log("设备列表导入"),this.uploadURL="/system/device/devicelock/upload/2/uploaddevicelock",this.downloadURL="",this.FileimportVisible=!0),355==e&&(console.log("设备列表导出"),this.getexcel())},getexcel:function(){var e=this,t="/system/device/devicelock/upload/1/downdevicelock",o=s.a.get("token");this.$post("".concat(t,"?token=").concat(o,"&buildid=").concat(this.fatheragid.buildid,"&search=").concat(this.search),{},"3").then(function(e){console.log(e)}).catch(function(t){console.log(t),e.download(t,"设备列表导出")})},download:function(e,t){var o=e;document.createElement("a");console.log("blob",o);var i=window.URL.createObjectURL(o);console.log("blobURL",i);var a=document.createElement("a");a.style.display="none",a.href=i;var l=new Date;"".concat(l.getFullYear()).concat(l.getMonth()).concat(l.getDate()).concat(l.getHours()).concat(l.getMinutes()).concat(l.getSeconds());a.setAttribute("download",t+l+".xlsx"),"undefined"===typeof a.download&&a.setAttribute("target","_blank"),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(i)},ks_click:function(e){console.log(this.value_zl),357!=e&&(0!=this.Selectedinformation.length?""!=this.value_zl?357==this.value_zl?this.savegatewayorder("状态查询"):358==this.value_zl?this.savegatewayorder("更新网关路由"):359==this.value_zl?this.savegatewayorder("强制变更为未安装"):360==this.value_zl&&this.savegatewayorder("强制变更为通讯正常"):this.$message({showClose:!0,message:"请先选择要下发的指令",type:"warning"}):this.$message({showClose:!0,message:"请先勾选网关",type:"warning"}))},savegatewayorder:function(e){var t=this;this.loading_pages=!0;var o=s.a.get("token"),i=this.fatheragid.buildid,a=[];this.Selectedinformation.map(function(e){a.push(e.roomid)});var l=this.value_fw,n=e;console.log("buildid",i),console.log("roomids",a),console.log("gotype",l),console.log("gotype2",n),console.log(o),this.$post("/system/device/devicelock/order/1/savelockorder?token=".concat(o,"&buildid=").concat(i,"&gotype=").concat(l,"&gotype2=").concat(n),a,"1").then(function(e){console.log(e.result),t.loading_pages=!1,t.$message({message:"指令下发成功",type:"success"}),t.getnextbuild()}).catch(function(e){console.log(e),t.loading_pages=!1,t.$message.error(e.resultMsg||"连接失败")})},dialogTableVisibleClose:function(){this.dialogTableVisible=!1},msclick:function(e){console.log(e),this.dialogTableVisible=!0,this.getlock(e)},select:function(e){console.log(e),this.Selectedinformation=e},selectall:function(e){console.log(e),this.Selectedinformation=e},modificationVisibleClose:function(){console.log("关闭11"),this.modificationVisible=!1,console.log(this.modificationVisible)},refresh:function(){this.getnextbuild()},addbuildingVisibleClose:function(){this.addbuildingVisible=!1},setdialogFormVisible:function(){this.dialogFormVisible=!1},buttonclick:function(e){var t=this;if(console.log(e),350==e){if(0==z()(this.gateway).length)return void this.$message({showClose:!0,message:"请先选中列表区域",type:"warning"});this.modificationVisible=!0,this.addbuildingbutid=e}else if(351==e){if(console.log(this.Selectedinformation),0==this.Selectedinformation.length)return void this.$message({showClose:!0,message:"请勾选中要删除的门锁",type:"warning"});this.$confirm("确定要解除当前位置和门锁的绑定关系吗？, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.updatebuild()})}},updatebuild:function(){var e=this,t=s.a.get("token"),o=[];this.Selectedinformation.map(function(e){o.push(e.roomid)}),console.log(this.Selectedinformation),console.log(o),console.log(t),this.$post("/system/device/devicelock/delete/1/deletedevicelock?token=".concat(t),o,"1").then(function(t){console.log(t.result),e.$message({message:"门锁解除绑定成功",type:"success"}),e.Selectedinformation=[],e.getnextbuild()}).catch(function(t){console.log(t),e.$message.error(t.resultMsg||"连接失败")})},openDetails:function(e){console.log(e),this.gateway=e},dialoghandleCurrent:function(e){this.page_kp=e,this.getnextbuild()},dialoghandleSize:function(e){this.rows_kp=e,this.getnextbuild()},handleNodeClick:function(e){console.log(e),this.fatheragid=e,this.getnextbuild()},getsonmenu:function(){var e=this,t=s.a.get("token");this.$post("/login/home/2/getsonmenu",{token:t,fatherid:this.pagesid}).then(function(t){console.log(t.result),e.buttoms=t.result;var o=[],i=[],a=[],l=[];t.result.map(function(t){352!=t.entity.id&&353!=t.entity.id||l.push(t),354!=t.entity.id&&355!=t.entity.id&&357!=t.entity.id||o.push(t),357!=t.entity.id&&358!=t.entity.id&&359!=t.entity.id&&360!=t.entity.id||a.push(t),350!=t.entity.id&&351!=t.entity.id||i.push(t),e.foortbuts=i,e.bus=a,e.bus_gg=l,e.topbut=o})}).catch(function(e){console.log(e)})},getnextbuild:function(){var e=this;this.tableloading=!0;var t=s.a.get("token");console.log(this.fatheragid),this.$post("/system/device/devicelock/2/getdevicelock?token=".concat(t,"&page=").concat(this.page_kp,"&rows=").concat(this.rows_kp,"&search=").concat(this.search),this.fatheragid,"1").then(function(t){console.log(t.result),e.gridData=t.result.data,e.total_kp=1*t.result.total,e.tableloading=!1}).catch(function(t){console.log(t),e.tableloading=!1})},getlock:function(e){var t=this,o=s.a.get("token");this.$post("/system/device/gateway/info/1/getlock",{token:o,gatewaycode:e.gatewaycode}).then(function(e){console.log(e.result),t.dialogTablegridData=e.result}).catch(function(e){console.log(e)})}},watch:{search:function(e){console.log(e),this.Selectedinformation=[],this.getnextbuild()}}},be=me,ve=(o("8d98"),Object(h["a"])(be,te,oe,!1,null,"8c559af4",null));ve.options.__file="msgl308.vue";var we=ve.exports,_e=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading_pages,expression:"loading_pages"}],staticClass:"libox",attrs:{"element-loading-text":"下发中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[o("el-container",{staticClass:"el-containerbox"},[o("el-aside",{staticClass:"leftbox",staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"210px"}},[o("trees",{ref:"trees_Component",attrs:{TreeURL:"/system/device/devicenblock/1/getbuildtree",Props:e.Props,addbuildingbutid:e.addbuildingbutid},on:{handleNodeClick:e.handleNodeClick}})],1),o("el-container",{staticClass:"mins"},[o("el-header",{staticClass:"elheader"},[o("div",{staticClass:"titlebox"},[e._v(e._s(e.fatheragid.buildlocation)+"(区域编号"+e._s(e.fatheragid.buildcode)+")")]),o("div",{staticClass:"heads rights"},[o("el-input",{staticClass:"inpts",attrs:{size:"small",placeholder:"请输入唯一ID/通讯ID搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._l(e.topbut,function(t,i){return[o("el-button",{key:t.entity.id,attrs:{type:"primary",size:"small"},nativeOn:{click:function(o){e.xz_click(t.entity.id,o)}}},[e._v(e._s(t.entity.alias))])]})],2)]),o("el-main",[o("Pub-Tabel",{attrs:{tableloading:e.tableloading,buttoms:e.buttoms,selection:!0,is_indx:!0,gridData:e.gridData,total_kp:e.total_kp,page_kp:e.page_kp,rows_kp:e.rows_kp,is_pagination:!0},on:{dialoghandleSize:e.dialoghandleSize,dialoghandleCurrent:e.dialoghandleCurrent,openDetails:e.openDetails,msclick:e.msclick,select:e.select,selectall:e.selectall}})],1),o("el-footer",{staticClass:"elfooter"},[o("div",{staticClass:"elfooterleftbox"},[o("el-select",{staticClass:"select_fw",attrs:{size:"small"},model:{value:e.value_fw,callback:function(t){e.value_fw=t},expression:"value_fw"}},[o("el-option",{attrs:{label:"勾选范围",value:"勾选范围"}}),o("el-option",{attrs:{label:"区域范围",value:"区域范围"}})],1),e.bus.length>0?[o("el-select",{staticClass:"select_zl",attrs:{size:"small",placeholder:"请选择需下发的指令"},model:{value:e.value_zl,callback:function(t){e.value_zl=t},expression:"value_zl"}},e._l(e.bus,function(e){return o("el-option",{key:e.entity.alias,attrs:{label:e.entity.alias,value:e.entity.id}})}),1),e._l(e.bus_gg,function(t,i){return[o("el-button",{key:t.entity.id,attrs:{type:"primary",size:"small"},nativeOn:{click:function(o){e.ks_click(t.entity.id,o)}}},[e._v(e._s(t.entity.alias))])]})]:e._e()],2),e._l(e.foortbuts,function(t,i){return[o("el-button",{key:t.entity.id,attrs:{type:"primary",size:"small"},nativeOn:{click:function(o){e.buttonclick(t.entity.id,o)}}},[e._v(e._s(t.entity.alias))])]})],2),o("Dialog-Tabel",{attrs:{dialogTableVisible:e.dialogTableVisible,gridData:e.dialogTablegridData,cols:e.dialogTablecols,title:"绑定门锁详情"},on:{handleDialogClose:e.setdialogFormVisible,Visible:e.dialogTableVisibleClose}}),o("addbuilding",{attrs:{dialogFormVisible:e.addbuildingVisible,buildinginfo:e.fatheragid,butid:e.addbuildingbutid},on:{handleDialogClose:e.addbuildingVisibleClose,refresh:e.refresh}}),o("modification",{attrs:{dialogFormVisible:e.modificationVisible,buildinginfo:e.gateway,butid:e.addbuildingbutid},on:{refresh:e.refresh,handleDialogClose:e.modificationVisibleClose}})],1),o("dialog-File",{attrs:{FileimportVisible:e.FileimportVisible,title:"设备列表导入",uploadURL:e.uploadURL,downloadURL:e.downloadURL},on:{handleDialogClose:e.handleDialogClose}})],1)],1)},ye=[],ke=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{height:"100%"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableloading,expression:"tableloading"}],ref:"tables",staticStyle:{width:"100%"},attrs:{data:e.gridData,border:"",height:"93%","row-class-name":e.tableRowClassName,"row-style":e.selectedHighlight},on:{"row-click":e.openDetails,"selection-change":e.handleSelectionChange,select:e.select,"select-all":e.selectall}},[e.selection?o("el-table-column",{attrs:{type:"selection",width:"40"}}):e._e(),e.is_indx?o("el-table-column",{attrs:{label:"序号","show-overflow-tooltip":!0,width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.$index+(1*e.page_kp-1)*(1*e.rows_kp)+1)+" ")])]}}])}):e._e(),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"roomlocation",label:"门锁位置",width:"200"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"roomcode2",label:"唯一ID"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"roomiccid",label:"ICCID"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"roomimei",label:"IMEI"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"roomstate",label:"通讯状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{class:"通讯正常"==t.row.roomstate?"puc-ps":"puc-px"},[e._v(e._s(t.row.roomstate))])]}}])}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"roommodel",label:"设备型号"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"lastactivedate",label:"最后通讯时间"}})],1),e.is_pagination?o("el-pagination",{attrs:{"current-page":e.currentPage1,background:"","page-sizes":[15,20,30,40,50],"page-size":e.rows_kp,layout:"total, sizes, prev, pager, next, jumper",total:e.total_kp},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},Ce=[],xe={props:["gridData","rows_kp","page_kp","total_kp","cols","is_searchbox","selection","tableloading","selectdata","is_select","butsload","checkedload","is_pagination","is_indx","buttoms"],data:function(){return{getIndex:"",currentPage1:1,input21:"",iscardchecked:!1,isfingerchecked:!1,selectvalue:"",this_row:{}}},computed:{buttomsbj:function(){var e=this.buttoms;return e.length>0?e:[]}},watch:{selectvalue:function(e){this.$emit("selectvalue",e)}},mounted:function(){},methods:{is_agtype:function(e){return"1"==e?"宿舍区域":"2"==e?"公共区域":"3"==e?"随房间属性":void 0},is_buildtype:function(e){return"1"==e?"园区":"2"==e?"楼栋":"3"==e?"楼层":"4"==e?"房间":"5"==e?"楼梯":"6"==e?"装饰间":"7"==e?"门禁":void 0},scecountclick:function(e,t){this.$emit("scecountclick",e,t)},msclick:function(e){this.$emit("msclick",e)},selectall:function(e){this.$emit("selectall",e)},selectedHighlight:function(e){e.row;var t=e.rowIndex;if(this.getIndex===t)return{"background-color":"#CAE1FF"}},tableRowClassName:function(e){var t=e.row,o=e.rowIndex;t.index=o},handleSelectionChange:function(e){this.$emit("handleSelectionChange",e)},select:function(e,t){this.$emit("select",e,t,this.$refs)},openDetails:function(e,t){this.getIndex=e.index,this.$emit("openDetails",e)},handleSizeChange:function(e){this.$emit("dialoghandleSize",e)},handleCurrentChange:function(e){this.$emit("dialoghandleCurrent",e)}}},De=xe,$e=(o("fdf1"),Object(h["a"])(De,ke,Ce,!1,null,"5357acef",null));$e.options.__file="PubTabel2.vue";var Ve=$e.exports,Se=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{attrs:{title:"管理NB门锁",visible:e.dialogFormVisible,"close-on-click-modal":!1,"before-close":e.handleDialogClose,width:"700px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{staticClass:"formbox",attrs:{"label-width":"100px","label-position":"left"}},[o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"房间位置"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomlocation||"--"))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"ICCID"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomiccid||"--"))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"门锁唯一ID"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomcode2||"--"))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"新唯一ID"}},[o("el-input",{staticClass:"inputs",attrs:{placeholder:"不填为不修改"},model:{value:e.wyid,callback:function(t){e.wyid=t},expression:"wyid"}})],1)],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"门锁IMEI"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomimei||"--"))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"新IMEI"}},[o("el-input",{staticClass:"inputs",attrs:{placeholder:"不填为不修改"},model:{value:e.IMEi,callback:function(t){e.IMEi=t},expression:"IMEi"}})],1)],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"IMSI"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomimsi||"--"))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"新IMSI"}},[o("el-input",{staticClass:"inputs",attrs:{placeholder:"不填为不修改"},model:{value:e.IMSI,callback:function(t){e.IMSI=t},expression:"IMSI"}})],1)],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"门锁型号"}},[o("el-select",{staticClass:"inputs",attrs:{"value-key":"value"},model:{value:e.region_roommodel,callback:function(t){e.region_roommodel=t},expression:"region_roommodel"}},e._l(e.roommodels,function(e){return o("el-option",{key:e.modelname,attrs:{label:e.modelname,value:e}})}),1)],1)],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"电池电量"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomcharge||"--"))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"软件版本号"}},[o("span",[e._v(e._s(e.updategatewayinfo.lockver||"--"))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"信号强度"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomsignal||"--"))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"信号覆盖等级"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomecl||"--"))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"信噪比"}},[o("span",[e._v(e._s(e.updategatewayinfo.roomsnr||"--"))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"小区ID"}},[o("span",[e._v(e._s(e.updategatewayinfo.roompci||"--"))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"联网频率"}},[o("span",[e._v(e._s(e.updategatewayinfo.spacetime||"--"))])])],1),o("div",{staticClass:"form-left"},[o("el-form-item",{attrs:{label:"最后通讯时间"}},[o("span",[e._v(e._s(e.updategatewayinfo.lastactivedate||"--"))])])],1)]),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.determine}},[e._v("确 定 修 改")])],1)],1)],1)},ze=[],Ie={props:["dialogFormVisible","buildinginfo"],data:function(){return{IMEi:"",IMSI:"",region_roommodel:"",gatewaycode2:"",region:"",roommodels:[],updategatewayinfo:{},gatewaytypes:[],wyid:""}},watch:{dialogFormVisible:function(e){console.log(this.buildinginfo),e&&this.getupdategatewayinfo()}},components:{},computed:{},mounted:function(){},methods:{determine:function(){this.updategateway()},handleDialogClose:function(){this.$emit("handleDialogClose"),this.gatewaycode2="",this.region=""},getupdategatewayinfo:function(){var e=this,t=s.a.get("token"),o=this.buildinginfo.roomid;this.$post("/system/device/devicenblock/update/1/getupdatedevicenblockinfo",{roomid:o,token:t}).then(function(t){console.log(t.result),e.updategatewayinfo=t.result,e.gatewaytypes=t.result.gatewaycodes,e.roommodels=t.result.nbroommodels}).catch(function(t){console.log(t),e.$message.error(t.resultMsg||"连接失败")})},refresh:function(){this.$emit("refresh")},updategateway:function(){var e=this;console.log("roomcode2",this.wyid),console.log("roomimsi",this.IMSI),console.log("roomimei",this.IMEi),console.log("roomid ",this.buildinginfo.roomid),console.log("roommodel ",this.region_roommodel);var t=s.a.get("token");this.$post("/system/device/devicenblock/update/2/updatedevicenblock?token=".concat(t,"&roomid=").concat(this.buildinginfo.roomid,"&roomcode2=").concat(this.wyid,"&roomimei=").concat(this.IMEi,"&roomimsi=").concat(this.IMSI),this.region_roommodel,"1").then(function(t){console.log(t.result),e.$message({message:"修改门锁成功",type:"success"}),e.handleDialogClose(),e.refresh()}).catch(function(t){console.log(t),e.$message.error(t.resultMsg||"连接失败")})}}},Te=Ie,Fe=(o("9cb4"),Object(h["a"])(Te,Se,ze,!1,null,"8fa22874",null));Fe.options.__file="modification2.vue";var Re=Fe.exports,Le={components:{trees:F["a"],PubTabel:Ve,DialogTabel:y,addbuilding:H,modification:Re,dialogFile:pe["a"]},data:function(){return{uploadURL:"",downloadURL:"",FileimportVisible:!1,titles:"",topbut:[],bus_gg:[],loading_pages:!1,dialogTableVisible:!1,dialogTablegridData:[],dialogTablecols:[{prop:"roomcode",label:"门锁通讯ID"},{prop:"roomcode2",label:"门锁唯一ID"},{prop:"roomlocation",label:"门锁位置"},{prop:"roommodel",label:"门锁型号"},{prop:"roomstate",label:"门锁状态"}],gateway:{},value_fw:"勾选范围",value_zl:"",Selectedinformation:[],modificationinfo:{},modificationVisible:!1,addbuildingbutid:"",dialogFormVisible:!1,tableloading:!1,addbuildingVisible:!1,pagesid:361,bus:[],fatheragid:{},fatheragid_xj:{},gridData:[],foortbuts:[],total_kp:0,search:"",rows_kp:15,page_kp:1,buttoms:[],Props:{children:"children",label:"buildname",isLeaf:function(e,t){var o=JSON.parse(T()(e));return 1==o.isnext?o.isnext=!1:o.isnext=!0,o.isnext}}}},computed:{},mounted:function(){this.getsonmenu(),this.getnextbuild()},methods:{handleDialogClose:function(){this.FileimportVisible=!1},xz_click:function(e){console.log(e),364==e&&(console.log("设备列表导入"),this.uploadURL="/system/device/devicenblock/upload/2/uploaddevicenblock",this.downloadURL="",this.FileimportVisible=!0),365==e&&(console.log("设备列表导出"),this.getexcel())},getexcel:function(){var e=this,t="/system/device/devicenblock/upload/1/downdevicenblock",o=s.a.get("token");this.$post("".concat(t,"?token=").concat(o,"&buildid=").concat(this.fatheragid.buildid,"&search=").concat(this.search),{},"3").then(function(e){console.log(e)}).catch(function(t){console.log(t),e.download(t,"设备列表导出")})},download:function(e,t){var o=e;document.createElement("a");console.log("blob",o);var i=window.URL.createObjectURL(o);console.log("blobURL",i);var a=document.createElement("a");a.style.display="none",a.href=i;var l=new Date;"".concat(l.getFullYear()).concat(l.getMonth()).concat(l.getDate()).concat(l.getHours()).concat(l.getMinutes()).concat(l.getSeconds());a.setAttribute("download",t+l+".xlsx"),"undefined"===typeof a.download&&a.setAttribute("target","_blank"),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(i)},ks_click:function(e){console.log(e),console.log(this.value_zl),368!=e&&(0!=this.Selectedinformation.length?0!=z()(this.fatheragid).length?""!=this.value_zl?369==this.value_zl?this.savegatewayorder("初始化NB门锁"):370==this.value_zl?this.savegatewayorder("强制变更为未安装"):371==this.value_zl&&this.savegatewayorder("强制变更为通讯正常"):this.$message({showClose:!0,message:"请先选择要下发的指令",type:"warning"}):this.$message({showClose:!0,message:"请选中左侧建筑",type:"warning"}):this.$message({showClose:!0,message:"请先勾选门锁",type:"warning"}))},savegatewayorder:function(e){var t=this;console.log("this.fatheragid",this.fatheragid),this.loading_pages=!0;var o=s.a.get("token"),i=this.fatheragid.buildid,a=[];this.Selectedinformation.map(function(e){a.push(e.roomid)});var l=this.value_fw,n=e;console.log("buildid",i),console.log("roomids",a),console.log("gotype",l),console.log("gotype2",n),console.log(o),this.$post("/system/device/devicenblock/order/1/savenblockorder?token=".concat(o,"&buildid=").concat(i,"&gotype=").concat(l,"&gotype2=").concat(n),a,"1").then(function(e){console.log(e.result),t.loading_pages=!1,t.$message({message:"指令下发成功",type:"success"}),t.getnextbuild()}).catch(function(e){console.log(e),t.loading_pages=!1,t.$message.error(e.resultMsg||"连接失败")})},dialogTableVisibleClose:function(){this.dialogTableVisible=!1},msclick:function(e){console.log(e),this.dialogTableVisible=!0,this.getlock(e)},select:function(e){console.log(e),this.Selectedinformation=e},selectall:function(e){console.log(e),this.Selectedinformation=e},modificationVisibleClose:function(){console.log("关闭11"),this.modificationVisible=!1,console.log(this.modificationVisible)},refresh:function(){this.getnextbuild()},addbuildingVisibleClose:function(){this.addbuildingVisible=!1},setdialogFormVisible:function(){this.dialogFormVisible=!1},buttonclick:function(e){var t=this;if(console.log(e),362==e){if(0==z()(this.gateway).length)return void this.$message({showClose:!0,message:"请先选中列表区域",type:"warning"});this.modificationVisible=!0,this.addbuildingbutid=e}else if(363==e){if(console.log(this.Selectedinformation),0==this.Selectedinformation.length)return void this.$message({showClose:!0,message:"请勾选中要删除的门锁",type:"warning"});this.$confirm("确定要解除当前位置和门锁的绑定关系吗？, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.updatebuild()})}},updatebuild:function(){var e=this,t=s.a.get("token"),o=[];this.Selectedinformation.map(function(e){o.push(e.roomid)}),console.log(this.Selectedinformation),console.log(o),console.log(t),this.$post("/system/device/devicelock/delete/1/deletedevicelock?token=".concat(t),o,"1").then(function(t){console.log(t.result),e.$message({message:"门锁解除绑定成功",type:"success"}),e.this.Selectedinformation=[],e.getnextbuild()}).catch(function(t){console.log(t),e.$message.error(t.resultMsg||"连接失败")})},openDetails:function(e){console.log(e),this.gateway=e},dialoghandleCurrent:function(e){this.page_kp=e,this.getnextbuild()},dialoghandleSize:function(e){this.rows_kp=e,this.getnextbuild()},handleNodeClick:function(e){console.log(e),this.fatheragid=e,this.getnextbuild()},getsonmenu:function(){var e=this,t=s.a.get("token");this.$post("/login/home/2/getsonmenu",{token:t,fatherid:this.pagesid}).then(function(t){console.log(t.result),e.buttoms=t.result;var o=[],i=[],a=[],l=[];t.result.map(function(t){367!=t.entity.id&&368!=t.entity.id||l.push(t),364!=t.entity.id&&365!=t.entity.id&&366!=t.entity.id||o.push(t),369!=t.entity.id&&370!=t.entity.id&&371!=t.entity.id||a.push(t),362!=t.entity.id&&363!=t.entity.id||i.push(t),e.foortbuts=i,e.bus=a,e.bus_gg=l,e.topbut=o})}).catch(function(e){console.log(e)})},getnextbuild:function(){var e=this;this.tableloading=!0;var t=s.a.get("token");console.log(this.fatheragid),this.$post("/system/device/devicenblock/2/getdevicenblock?token=".concat(t,"&page=").concat(this.page_kp,"&rows=").concat(this.rows_kp,"&search=").concat(this.search),this.fatheragid,"1").then(function(t){console.log(t.result),e.gridData=t.result.data,e.total_kp=1*t.result.total,e.tableloading=!1}).catch(function(t){console.log(t),e.tableloading=!1})},getlock:function(e){var t=this,o=s.a.get("token");this.$post("/system/device/gateway/info/1/getlock",{token:o,gatewaycode:e.gatewaycode}).then(function(e){console.log(e.result),t.dialogTablegridData=e.result}).catch(function(e){console.log(e)})}},watch:{search:function(e){console.log(e),this.Selectedinformation=[],this.getnextbuild()}}},Ue=Le,Pe=(o("6535"),Object(h["a"])(Ue,_e,ye,!1,null,"10d667d2",null));Pe.options.__file="msgl361.vue";var Ne=Pe.exports,Me={data:function(){return{pagesid:34,this_options:"306"}},components:{zlfwqgl306:D,wggl307:ee,msgl308:we,msgl361:Ne},computed:{options:function(){var e=JSON.parse(s.a.get("sbgl34_routes"));return e}},watch:{this_options:function(e){console.log(e)}},mounted:function(){this.getsonmenu()},methods:{handleClick:function(){console.log(this.this_options)},getsonmenu:function(){console.log(this.options);var e=s.a.get("token");this.$post("/login/home/2/getsonmenu",{token:e,fatherid:this.pagesid}).then(function(e){console.log(e.result)}).catch(function(e){console.log(e)})}}},je=Me,Ee=(o("b277"),o("f59a"),Object(h["a"])(je,i,a,!1,null,"18d593e3",null));Ee.options.__file="sbgl34.vue";t["default"]=Ee.exports},caf5:function(e,t,o){"use strict";var i=o("4fb6"),a=o.n(i);a.a},ce0f:function(e,t,o){},d4e7:function(e,t,o){"use strict";var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"box"},[o("el-tree",{staticClass:"treebox",attrs:{data:e.treedatas,props:e.defaultProps,"render-after-expand":"","highlight-current":!0,load:e.loadNode1,lazy:"","node-key":"buildid","default-expanded-keys":e.idArr},on:{"node-click":e.handleNodeClick}})],1)},a=[],l=o("a4bb"),s=o.n(l),n=(o("fa7d"),o("a78e")),c=o.n(n),r=(o("2f62"),{props:["pagesid","TreeURL","Props","addbuildingbutid"],data:function(){return{pagesids:this.pagesid,thistab:"",treedatas:[],idArr:[],defaultProps:this.is_defaultProps()}},methods:{is_defaultProps:function(){return"undefined"!=typeof this.Props?this.Props:{children:"children",label:"agname",isLeaf:"isnext"}},handleNodeClick:function(e){this.$emit("handleNodeClick",e)},Therefresh:function(){this.getTreeData()},getTreeData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,i=c.a.get("token");this.$post("".concat(this.TreeURL,"?token=").concat(i),t,"1").then(function(i){if(console.log(i.result),0!=s()(t).length)return o(i.result);e.treedatas=i.result,e.idArr.push(i.result[0].buildid)}).catch(function(e){console.log(e)})},loadNode1:function(e,t){if(0!=e.level){var o=e.data;this.getTreeData(o,t)}}},mounted:function(){this.getTreeData()},watch:{pagesid:function(e){this.pagesids=e}}}),d=r,u=(o("caf5"),o("2877")),g=Object(u["a"])(d,i,a,!1,null,"3a652c92",null);g.options.__file="PubTree2.vue";t["a"]=g.exports},d5f3:function(e,t,o){"use strict";var i=o("6ad2"),a=o.n(i);a.a},de74:function(e,t,o){},e90f:function(e,t,o){},f370:function(e,t,o){},f59a:function(e,t,o){"use strict";var i=o("71c2"),a=o.n(i);a.a},f9ce:function(e,t,o){"use strict";var i=o("a6c6"),a=o.n(i);a.a},fdf1:function(e,t,o){"use strict";var i=o("de74"),a=o.n(i);a.a},fef2:function(e,t,o){"use strict";var i=o("ce0f"),a=o.n(i);a.a}}]);
//# sourceMappingURL=chunk-0668bf86.dc66b50e.js.map