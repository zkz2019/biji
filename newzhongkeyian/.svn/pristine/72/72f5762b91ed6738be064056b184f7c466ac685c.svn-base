<template>
  <el-dialog
    title="人员列表"
    width="76%"
    top="10vh"
    :close-on-click-modal="false"
    append-to-body
    :before-close="beforeClose"
    :visible.sync="dialogVisible"
  >
    <el-container class="dialog-table6 wh100">
      <paging-table
        :interface="interfaceUrl"
        :param="param"
        @onSelect="onSelect"
        :refresh="refresh"
        :list="list"
      >
        <span class="sli">
          <el-input
            clearable
            class="search wid300"
            v-model="param.search"
            :placeholder="'输入'+getNumber()+'/姓名/手机号进行检索'"
          ></el-input>
          <fel-button type="primary" @click="onRefresh">查询</fel-button>
        </span>
      </paging-table>
    </el-container>
  </el-dialog>
</template>

<script>
import { mapGetters } from "vuex";
export default {
  props: {
    param: {
      type: Object,
      default() {
        return {
          search: ""
        };
      }
    },
    interfaceUrl: {
      type: String,
      default: "/auth/cardcenter/card/savecard/8/getcardperson"
    },
    dialogVisible: Boolean
  },
  data() {
    return {
      refresh: 0,
      list: [
        {
          name: "序号",
          type: "$index",
          width: "60px"
        },
        {
          name: "姓名",
          prop: "personname"
        },
        {
          name: this.getNumber(),
          prop: "personcode"
        },
        {
          name: "归属组织",
          prop: "personlocation",
          tooltip: true
        },
        {
          name: "手机号",
          prop: "personmobile"
        },
        {
          name: "人员类型",
          prop: "persontypename"
        },
        {
          name: "邮箱",
          prop: "personemail"
        },
        {
          name: "身份证",
          prop: "personcard"
        }
      ]
    };
  },
  watch: {
    dialogVisible() {
      if (this.dialogVisible) {
        this.onRefresh();
      }
    }
  },
  methods: {
    ...mapGetters(["getNumber"]),
    onRefresh() {
      this.refresh = new Date().getTime();
    },
    beforeClose() {
      this.$emit("beforeClose");
    },
    onSelect(data) {
      this.$emit("onSelect", data);
    }
  }
};
</script>