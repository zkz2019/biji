<!--  选中区域时的房间管理展示 -->
<template>
  <el-container class="fjglBox">
    <el-header class="fjglBox_top">
      <h3>房间管理</h3>
      <div class="fjglBox_top_right">
        <div class="fjglBox_top_right_btn">
          <el-button
            class="fjglBox_top_right_btn1 com-but-small"
            :class="{c333:!visble}"
            type="text"
            @click.stop="visble=true"
          >实体</el-button>
          <el-button
            class="fjglBox_top_right_btn2 com-but-small"
            :class="{c333:visble}"
            type="text"
            @click.stop="visble=false"
          >列表</el-button>
        </div>
        <!-- 批量下发按钮 -->
        <el-button
          v-if="btnAll.plxfBtn.entity"
          type="primary"
          class="com-but-small"
          @click.stop="link_batch(btnAll.plxfBtn)"
        >{{btnAll.plxfBtn.entity.alias}}</el-button>
        <!-- 导入导出 -->
        <el-button
          v-if="btnAll.drydcBtn.topBtns.alias"
          class="com-but-small"
          type="primary"
          @click.stop="onFile"
        >{{btnAll.drydcBtn.topBtns.alias}}</el-button>
      </div>
    </el-header>
    <imgList
      v-if="visble"
      :refresh="refresh"
      :param="param"
      @toRegion="toRegion"
      @toFloor="toFloor"
    ></imgList>
    <tableList v-else :refresh="refresh" :btnAll="btnAll" :param="param"></tableList>
    <guideFile
      :dialogVisible="dialogGuideFile"
      :importButs="btnAll.drydcBtn.importButs"
      :exportButs="btnAll.drydcBtn.exportButs"
      :exImportButs="btnAll.drydcBtn.exImportButs"
      :ggexportButs="btnAll.drydcBtn.ggexportButs"
      :ggimportButs="btnAll.drydcBtn.ggimportButs"
      :ggexImportButs="btnAll.drydcBtn.ggexImportButs"
      detailsUrl="lock/upload/d/downauthpersonhistorydetails"
      historyUrl="lock/upload/c/downauthpersonhistory"
      failUrl="lock/upload/y/downauthpersonexcel"
      :importShow="true"
      @handleClose="dialogGuideFile=false"
    ></guideFile>
  </el-container>
</template>

<script>
import guideFile from "./dialog/fjguideFile";
import { mapMutations } from "vuex";
import imgList from "./imgList";
import tableList from "./tableList";
export default {
  props: {
    param: Object,
    refresh: Number,
    btnAll: Object
  },
  components: { imgList, tableList, guideFile },
  data() {
    return {
      visble: true,
      dialogGuideFile: false
    };
  },
  computed: {
    menuObj() {
      return this.$store.state.openTab.menuObj;
    }
  },
  mounted() {},
  methods: {
    ...mapMutations(["add_tabs", "set_active_index", "addMenuObj"]),
    onFile() {
      //导入导出弹框
      this.dialogGuideFile = true;
    },
    link_batch(val) {
      if (Object.keys(val).length == 0) return;
      this.addMenuObj({
        alias: "批量下发",
        icon: "image254",
        id: 7343,
        isnext: "0",
        parent: "",
        value: "plxf"
      });
      this.toPath("plxf");
    },
    toPath(tab) {
      let obj = this.menuObj[tab];
      if (obj) {
        this.add_tabs({
          index: tab,
          name: obj.alias,
          id: obj.id
        });
        this.set_active_index(tab);
        this.$router.push({ path: tab });
      }
    },
    toFloor(data) {
      this.$emit("toFloor", data);
    },
    toRegion(data) {
      this.$emit("toRegion", data);
    }
  }
};
</script>

<style lang="scss">
</style>
