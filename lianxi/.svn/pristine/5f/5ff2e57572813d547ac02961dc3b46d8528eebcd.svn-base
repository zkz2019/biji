<!-- 系统日志  系统运行 -->
<template>
  <el-container class="xtrz113">
    <el-header class="elheader query_headbox">
      <retrieval class="query_head">
        <fel-date v-model="dates"></fel-date>
        <el-input
          class="mar10-10-0 con-search qh_inp"
          clearable
          v-model="param.search"
          placeholder="请输入账号/姓名进行搜索"
        ></el-input>
        <el-button class="qh_btn" type="primary" @click="search">查询</el-button>
        <fel-button class="qh_btn" @click="onReset">重置</fel-button>
      </retrieval>
    </el-header>
    <el-main class="pad0-10 query_main">
      <paging-table
        height="100%"
        interface="/system/log/1/getlog"
        class="heig100"
        :param="param"
        :refresh="refresh"
        :list="list"
      />
    </el-main>
  </el-container>
</template>

<script>
import { format } from "@/utils/utils.js";
export default {
  data() {
    return {
      dates: [],
      refresh: 0,
      param: {
        search: "",
        edate: "",
        sdate: ""
      },
      list: [
        {
          name: "序号",
          type: "$index",
          width: "60px"
        },
        {
          name: "日志类型",
          prop: "logtype",
          width: "100px"
        },
        {
          name: "日志标题",
          prop: "logtitle"
        },
        {
          tooltip: false,
          name: "日志内容",
          prop: "logcontent"
        },
        {
          name: "操作人账号",
          prop: "userlogin",
          width: "100px"
        },
        {
          name: "操作人",
          prop: "username",
          width: "120px"
        },
        {
          name: "最后通讯时间",
          prop: "logdate",
          width: "200px"
        }
      ]
    };
  },
  methods: {
    //重置事件
    onReset() {
      this.dates = [];
      Object.keys(this.param).forEach(key => {
        this.param[key] = "";
      });
      this.search();
    },
    search() {
      if (this.dates && this.dates.length == 2) {
        this.param.sdate = format(this.dates[0], "yyyy-MM-dd HH:mm:ss");
        this.param.edate = format(this.dates[1], "yyyy-MM-dd HH:mm:ss");
      } else {
        this.param.sdate = "";
        this.param.edate = "";
      }
      this.refresh = new Date().getTime();
    }
  }
};
</script>